{"version":3,"sources":["../../src/pages/lots/lots.module.ts","../../src/pages/lots/lots.ts"],"names":[],"mappings":"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","file":"4.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { LotsPage } from './lots';\n\n@NgModule({\n  declarations: [\n    LotsPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(LotsPage),\n  ],\n})\nexport class LotsPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/lots/lots.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\nimport { FormBuilder, FormGroup, FormArray, Validators } from '@angular/forms';\n\nimport { LotsProvider } from '../../providers/lots/lots';\nimport { GameProvider } from '../../providers/game/game';\n\n\n@IonicPage()\n@Component({\n  selector: 'page-lots',\n  templateUrl: 'lots.html',\n})\nexport class LotsPage {\n  private borne;\n  private pageTitle: string = 'Lots ';\n  private lotsForm: FormGroup;\n  //private lots:any;\n  private lotsList:any;\n  private lotsServiceSub;\n  private arrayOfKeys;\n  private scoresSub;\n  private scores;\n\n  constructor(\n    public navCtrl: NavController,\n    private lotsService: LotsProvider,\n    private gameService: GameProvider,\n    public formBuilder: FormBuilder,\n    public navParams: NavParams\n  ) {\n    this.borne = this.navParams.get('borne');\n  }\n\n  ionViewDidLoad() {\n    console.log('ionViewDidLoad LotsPage', this);\n    /*this.lotsForm = this.formBuilder.group({\n      lots: this.formBuilder.array([  ])\n    });*/\n    if(this.borne){\n      this.init();\n      this.pageTitle = 'Lots : '  + this.borne.replace('_', ' ');\n    }\n\n  }\n\n  ionViewDidLeave(){\n    if(this.scoresSub){\n      this.scoresSub.unsubscribe();\n    }\n    if(this.lotsServiceSub){\n      this.lotsServiceSub.unsubscribe();\n    }\n  }\n\n  init(){\n    this.lotsServiceSub = this.lotsService.get(this.borne).subscribe(res => {\n      if(res){\n        this.arrayOfKeys = Object.keys(res);\n        this.lotsList = res;\n\n        /*for (let key in this.lotsList) {\n          this.initLot(this.lotsList[key]);\n        }*/\n\n\n        this.scoresSub = this.gameService.getScrores(this.borne).map(res => {\n          let scores = {};\n          for (let key in this.lotsList) {\n            scores[key] = 0;\n          }\n          res.forEach(day => {\n            for (let key in this.lotsList) {\n              if(day[key]){\n                scores[key] = scores[key]+day[key];\n              }\n            }\n          });\n          return scores;\n        }).subscribe(res => this.scores = res );\n\n      }\n    });\n  }\n\n  saveLots(){\n    this.lotsService.set(this.lotsList);\n  }\n\n  removeLot(key){\n    delete this.lotsList[key];\n    let index = 1;\n    let _lotsList = {};\n    for (let key in this.lotsList) {\n      let keyIndex = index++;\n      let newKey = 'lot_'+keyIndex;\n      this.lotsList[key].id = keyIndex;\n      _lotsList[newKey] = this.lotsList[key];\n    }\n    console.log(_lotsList);\n    this.lotsList = _lotsList;\n    this.arrayOfKeys = Object.keys(this.lotsList);\n  }\n  addLot(): void {\n    let index = this.arrayOfKeys.length+1;\n    let key = 'lot_'+index;\n    this.lotsList[key] = {\n      id: index,\n      label_admin: 'label admin',\n      label: 'label',\n      limitPerDay: 30,\n      quantity: 0,\n    }\n    this.arrayOfKeys = Object.keys(this.lotsList);\n    console.log(this.lotsList);\n  }\n\n//https://scotch.io/tutorials/how-to-build-nested-model-driven-forms-in-angular-2\n  /*\n  createLot(lot = null): FormGroup {\n    return this.formBuilder.group({\n      id: (lot) ? lot.id : '',\n      label: (lot) ? lot.label : '',\n      label_admin: (lot) ? lot.label_admin : '',\n      limitPerDay: (lot) ? lot.limitPerDay : '',\n      quantity: (lot) ? lot.quantity : ''\n    });\n  }\n\n  initLot(lot): void {\n    this.lots = this.lotsForm.get('lots') as FormArray;\n    this.lots.push(this.createLot(lot));\n  }\n\n  addLot(): void {\n    //this.lots = this.lotsForm.get('lots') as FormArray;\n    this.lots.push(this.createLot());\n  }\n  */\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/lots/lots.ts"],"sourceRoot":""}